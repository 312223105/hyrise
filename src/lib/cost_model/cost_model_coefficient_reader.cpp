#include "cost_model_coefficient_reader.hpp"

namespace opossum {

const CoefficientsPerGroup CostModelCoefficientReader::default_coefficients() {
  CoefficientsPerGroup all_coefficients{};

  const auto table_scan_coefficients = read_table_scan_coefficients();
  const auto join_coefficients = read_join_coefficients();

  all_coefficients.insert(table_scan_coefficients.begin(), table_scan_coefficients.end());
  all_coefficients.insert(join_coefficients.begin(), join_coefficients.end());

  return all_coefficients;
}

// Hard-coded efficients for now
const CoefficientsPerGroup CostModelCoefficientReader::read_table_scan_coefficients(const std::string& file_path) {
  return {{ModelGroup{OperatorType::TableScan, DataType::Int, false, false},
           {{"left_input_row_count", 3.6579310596},
            //                          {"is_result_empty", -3894.4296670012},
            {"selectivity", 11285.9587666981},
            {"first_column_is_reference_segment", 0},
            {"second_column_is_reference_segment", 0},
            {"third_column_is_reference_segment", 0},
            {"is_column_comparison", -1721.1127107658},
            {"computable_or_column_expression_count", 14227.0873454307},
            {"is_selectivity_below_50_percent", 1874.7617189885},
            {"selectivity_distance_to_50_percent", -17721.3571372186},
            //                          {"is_small_table", 0},
            {"first_column_segment_encoding_Unencoded_percentage", 875.4659477475},
            {"first_column_segment_encoding_Dictionary_percentage", -2466.8790265752},
            {"first_column_segment_encoding_RunLength_percentage", 807.0515189504},
            {"first_column_segment_encoding_FixedStringDictionary_percentage", 0},
            {"first_column_segment_encoding_FrameOfReference_percentage", 2365.7972807862},
            //                          {"first_column_segment_encoding_undefined", 0},
            //                          {"first_column_data_type_null", 1581.4357209088},
            {"first_column_data_type_int", 1581.4357209088},
            {"first_column_data_type_long", 1581.4357209088},
            {"first_column_data_type_float", 1581.4357209088},
            {"first_column_data_type_double", 1581.4357209088},
            {"first_column_data_type_string", 1581.4357209088},
            {"first_column_data_type_undefined", 1581.4357209088},
            {"second_column_segment_encoding_Unencoded_percentage", -156.771035114},
            {"second_column_segment_encoding_Dictionary_percentage", -504.0943341712},
            {"second_column_segment_encoding_RunLength_percentage", -691.4961272456},
            {"second_column_segment_encoding_FixedStringDictionary_percentage", 0},
            {"second_column_segment_encoding_FrameOfReference_percentage", -368.7512142351},
            //                          {"second_column_segment_encoding_undefined", 3302.5484316746},
            //                          {"second_column_data_type_null", -1721.1127107658},
            {"second_column_data_type_int", -1721.1127107658},
            {"second_column_data_type_long", -1721.1127107658},
            {"second_column_data_type_float", -1721.1127107658},
            {"second_column_data_type_double", -1721.1127107658},
            {"second_column_data_type_string", -1721.1127107658},
            {"second_column_data_type_undefined", 3302.5484316746},
            {"third_column_segment_encoding_Unencoded_percentage", 4453.3879124653},
            {"third_column_segment_encoding_Dictionary_percentage", 2251.3754879083},
            {"third_column_segment_encoding_RunLength_percentage", 3768.4614356163},
            {"third_column_segment_encoding_FixedStringDictionary_percentage", 0},
            {"third_column_segment_encoding_FrameOfReference_percentage", 2312.1037783889},
            //                          {"third_column_segment_encoding_undefined", -11203.8928934701},
            //                          {"third_column_data_type_null", 12785.3286143789},
            {"third_column_data_type_int", 12785.3286143789},
            {"third_column_data_type_long", 12785.3286143789},
            {"third_column_data_type_float", 12785.3286143789},
            {"third_column_data_type_double", 12785.3286143789},
            {"third_column_data_type_string", 12785.3286143789},
            {"third_column_data_type_undefined", -11203.892893470}}}};
}

const CoefficientsPerGroup CostModelCoefficientReader::read_join_coefficients(const std::string& file_path) {
  return {{ModelGroup{OperatorType::JoinHash, {}, false},
           {{"input_table_size_ratio", 37.34331086716445},
            {"left_column_memory_usage_bytes", -0.06758319466691898},
            {"left_column_segment_encoding_Dictionary_percentage", 5030.0791317820085},
            {"left_column_segment_encoding_RunLength_percentage", 9136.68844408668},
            {"left_column_segment_encoding_Unencoded_percentage", -1775.0238968912763},
            {"left_input_row_count", -8.840868109290055},
            {"right_column_memory_usage_bytes", 5.578652731382208},
            {"right_column_segment_encoding_Dictionary_percentage", 5030.079131784199},
            {"right_column_segment_encoding_RunLength_percentage", 9136.688444089485},
            {"right_column_segment_encoding_Unencoded_percentage", -1775.0238968907097},
            {"right_input_row_count", 27.511556017551143},
            {"total_row_count", 7.102613508614716e-06},
            {"logical_cost_sort_merge", 1.3631030162005886},
            {"logical_cost_hash", 18.67068720605409},
            {"left_column_data_type_int", 12391.743678982917},
            {"right_column_data_type_int", 12391.743678982928}}},
          {ModelGroup{OperatorType::JoinHash, {}, true},
           {{"input_table_size_ratio", 23.429834329425976},
            {"left_column_memory_usage_bytes", 15925.376471334415},
            {"left_column_segment_encoding_Dictionary_percentage", -1268659.9100489097},
            {"left_column_segment_encoding_RunLength_percentage", -1259600.285429189},
            {"left_column_segment_encoding_Unencoded_percentage", -1271891.3374584748},
            {"left_input_row_count", 357222.53125718277},
            {"right_column_memory_usage_bytes", 165813.3468639756},
            {"right_column_segment_encoding_Dictionary_percentage", -1268659.9105066468},
            {"right_column_segment_encoding_RunLength_percentage", -1259600.2855210034},
            {"right_column_segment_encoding_Unencoded_percentage", -1271891.3372597946},
            {"right_input_row_count", -841835.2299160174},
            {"total_row_count", 5.022867957068617e-06},
            {"logical_cost_sort_merge", 2.1760407292213246},
            {"logical_cost_hash", -484612.5645313488},
            {"left_column_data_type_int", -3800151.533653268},
            {"right_column_data_type_int", -3800151.5336532597}}},
          {ModelGroup{OperatorType::JoinNestedLoop, {}, false},
           {{"input_table_size_ratio", -4.334191123763469},
            {"left_column_memory_usage_bytes", -3.4254406520232323},
            {"left_column_segment_encoding_Dictionary_percentage", 2260.929719560555},
            {"left_column_segment_encoding_RunLength_percentage", 8934.647326152646},
            {"left_column_segment_encoding_Unencoded_percentage", -1079.3463505720456},
            {"left_input_row_count", 23.61487799489387},
            {"right_column_memory_usage_bytes", -0.22747976766516442},
            {"right_column_segment_encoding_Dictionary_percentage", 2260.9297195571335},
            {"right_column_segment_encoding_RunLength_percentage", 8934.647326152595},
            {"right_column_segment_encoding_Unencoded_percentage", -1079.346350572062},
            {"right_input_row_count", -10.767925567958795},
            {"total_row_count", 1.2861088197206516},
            {"logical_cost_sort_merge", 4.000245335723534},
            {"logical_cost_hash", 12.846952427493402},
            {"left_column_data_type_int", 10116.230695137672},
            {"right_column_data_type_int", 10116.230695137683}}},
          {ModelGroup{OperatorType::JoinNestedLoop, {}, true},
           {{"input_table_size_ratio", -12.286635272896666},
            {"left_column_memory_usage_bytes", -1137967.7508398572},
            {"left_column_segment_encoding_Dictionary_percentage", 8082421.66437864},
            {"left_column_segment_encoding_RunLength_percentage", 8090895.825797888},
            {"left_column_segment_encoding_Unencoded_percentage", 8076296.891876887},
            {"left_input_row_count", 6026973.500065296},
            {"right_column_memory_usage_bytes", -16112.162831425954},
            {"right_column_segment_encoding_Dictionary_percentage", 8082421.765417781},
            {"right_column_segment_encoding_RunLength_percentage", 8090895.818057516},
            {"right_column_segment_encoding_Unencoded_percentage", 8076296.89197764},
            {"right_input_row_count", -2949036.4330507265},
            {"total_row_count", 5.801062265720329},
            {"logical_cost_sort_merge", 89.61619100723325},
            {"logical_cost_hash", 3077937.0720860306},
            {"left_column_data_type_int", 24249614.4754682},
            {"right_column_data_type_int", 24249614.4754682}}},
          {ModelGroup{OperatorType::JoinMPSM, {}, false},
           {{"input_table_size_ratio", 11.576806178009608},
            {"left_column_memory_usage_bytes", 1.915676641762398},
            {"left_column_segment_encoding_Dictionary_percentage", 7535.205571680675},
            {"left_column_segment_encoding_RunLength_percentage", 11543.02820320745},
            {"left_column_segment_encoding_Unencoded_percentage", 2675.6509797726194},
            {"left_input_row_count", 9.012300284425653},
            {"right_column_memory_usage_bytes", 1.9355260105094292},
            {"right_column_segment_encoding_Dictionary_percentage", 7535.20557168616},
            {"right_column_segment_encoding_RunLength_percentage", 11543.028203217364},
            {"right_column_segment_encoding_Unencoded_percentage", 2675.6509797631534},
            {"right_input_row_count", 8.061853819157438},
            {"total_row_count", 5.948052028838834e-06},
            {"logical_cost_sort_merge", 2.5035932997377572},
            {"logical_cost_hash", 17.07415343406543},
            {"left_column_data_type_int", 21753.884754667033},
            {"right_column_data_type_int", 21753.884754666677}}},
          {ModelGroup{OperatorType::JoinMPSM, {}, true},
           {{"input_table_size_ratio", 0.3993263860757914},
            {"left_column_memory_usage_bytes", 54798.873070753885},
            {"left_column_segment_encoding_Dictionary_percentage", -626854.1014006071},
            {"left_column_segment_encoding_RunLength_percentage", -617299.4050531334},
            {"left_column_segment_encoding_Unencoded_percentage", -629205.5180420353},
            {"left_input_row_count", -197085.6513223837},
            {"right_column_memory_usage_bytes", 35662.27141167842},
            {"right_column_segment_encoding_Dictionary_percentage", -626854.1015089926},
            {"right_column_segment_encoding_RunLength_percentage", -617299.4052351861},
            {"right_column_segment_encoding_Unencoded_percentage", -629205.5178138376},
            {"right_input_row_count", -44089.375517334454},
            {"total_row_count", 7.96560724033249e-06},
            {"logical_cost_sort_merge", 8.62736511917269},
            {"logical_cost_hash", -241175.7528822671},
            {"left_column_data_type_int", -1873359.0248751005},
            {"right_column_data_type_int", -1873359.0245735466}}},
          {ModelGroup{OperatorType::JoinSortMerge, {}, false},
           {{"input_table_size_ratio", -9.3445222443782},
            {"left_column_memory_usage_bytes", 1.8386690352449935},
            {"left_column_segment_encoding_Dictionary_percentage", 4445.553464812317},
            {"left_column_segment_encoding_RunLength_percentage", 8551.59206265161},
            {"left_column_segment_encoding_Unencoded_percentage", -898.2774390416553},
            {"left_input_row_count", 0.8301397523135385},
            {"right_column_memory_usage_bytes", 2.383841228522659},
            {"right_column_segment_encoding_Dictionary_percentage", 4445.553464824212},
            {"right_column_segment_encoding_RunLength_percentage", 8551.592062652513},
            {"right_column_segment_encoding_Unencoded_percentage", -898.2774390348823},
            {"right_input_row_count", 6.2772768505661265},
            {"total_row_count", 5.784508868593668e-06},
            {"logical_cost_sort_merge", 3.250869326533093},
            {"logical_cost_hash", 7.1074167013380425},
            {"left_column_data_type_int", 12098.868088441717},
            {"right_column_data_type_int", 12098.868088441715}}},
          {ModelGroup{OperatorType::JoinSortMerge, {}, true},
           {{"input_table_size_ratio", -3.6463512706569428},
            {"left_column_memory_usage_bytes", 105199.77695694836},
            {"left_column_segment_encoding_Dictionary_percentage", -1001543.9366488516},
            {"left_column_segment_encoding_RunLength_percentage", -992735.1733275538},
            {"left_column_segment_encoding_Unencoded_percentage", -1004847.0002386463},
            {"left_input_row_count", -458692.8488446175},
            {"right_column_memory_usage_bytes", 38369.89822597422},
            {"right_column_segment_encoding_Dictionary_percentage", -1001543.9367353321},
            {"right_column_segment_encoding_RunLength_percentage", -992735.173283424},
            {"right_column_segment_encoding_Unencoded_percentage", -1004847.0002206921},
            {"right_input_row_count", 75880.2839991547},
            {"total_row_count", 1.4240217368852085e-05},
            {"logical_cost_sort_merge", 8.429336854568124},
            {"logical_cost_hash", -382810.98665394867},
            {"left_column_data_type_int", -2999126.1106099277},
            {"right_column_data_type_int", -2999126.1106099277}}},
          };
}

}  // namespace opossum
